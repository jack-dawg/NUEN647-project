clear all; clc;
tic
%% User options
P=12;
Nmc = 2e3;
n_var = 1;
%
%% Data
m_dot = 0.048; alpha_s = 20; Tsteam = 403.15; cooling = 2e4; % problem data
stdev = 0.01; % input uncertainty
m1 = m_dot*stdev; alpha1 = alpha_s*stdev; Tsteam1 = Tsteam*stdev; cooling1 = cooling*stdev;

%% LHS
xi = [0.549443942731096,1.80074887843665,-2.38150373639388,0.905143954451307,0.320711142521578,-1.31044997938413,-0.453169033856728,0.346656063284052,3.63652082038537,2.52340870007794,-1.35501857721007,2.74978331806838,0.755271821184525,-0.0633353072012536,0.736343647779026,-0.193062738482941,-0.112918292810366,1.50282417970249,1.42748901365624,1.44741144345310,0.706063795861819,-1.22817792368327,0.743365172921072,1.63311098717888,0.498908281629445,1.09573170193886,0.756576121417942,-0.328522406726458,0.290625425819602,-0.780321749116575,0.932675598273201,-1.15073577867807,-1.07413290137645,-0.804171798759734,-2.83208686715167,1.46848066345995,0.327919796007546,-0.743207105806769,1.39551664531305,-1.74148776189087,-0.0961920191708429,-0.240406985470452,0.321859049553756,0.312140706052486,-0.862741414242729,-0.0294371283522356,-0.153047307266632,0.657456182135161,1.15229776094283,1.17649941445031,-0.859603174187321,0.0622015205449611,-1.23901175854067,-1.11209187014954,-0.0125276809688631,1.54787180861730,-0.757264251368990,0.374494948668446,-0.215494360108853,1.18361084763241,-1.09609309676858,0.0178655578641230,0.575929971751218,1.16870299884069,1.55788760372534,0.0740608161685881,-1.50447231737175,-0.737250990838567,-1.06405521886662,2.15044899778858,-0.626570257782246,0.772378918401803,-0.178067713382399,0.936084464369237,-0.755605009795644,-1.39941331185535,-1.42980996702498,0.497761723917515,-0.165012885568352,-0.183093611129803,1.45279089672978,0.285997460925785,0.200046351628217,1.58592680634102,-0.802270153026320,0.726090543319161,0.877686393208565,-0.242979296234013,0.214895752336219,-1.17511339210189,-1.15391797714386,0.0975046353761694,0.749376675580030,2.32204896616573,-0.681713522705195,0.192177517206212,-0.0810526005231150,-1.93044622496900,-0.459375447487691,-1.80877358801864,0.884534531511366,-0.883637453721098,0.0910411729099920,-0.562832250543563,0.299509741512670,-0.614031373209694,0.500531545000649,0.763991621624346,1.69512246107115,-0.179200439439703,-2.15018786064839,-0.832651213829024,1.38585872824612,-1.07684811610485,1.01662169772463,0.120535328797527,1.46200111144174,-1.97302068703878,-0.185546929805060,-1.23033199857925,2.64501662804872,0.861883381932043,1.40383378517155,-1.06239107856812,-0.485977910761181,-0.279096271907142,1.15613341274350,-0.287850402845984,0.731210631016212,-2.05093404175474,-0.370640233048633,-0.816660577663733,-1.60731339272511,0.523977337222044,0.273876001305065,0.0188932124348636,-1.34096499049349,1.18610434913067,0.353602032117564,-0.318179567581001,0.0127031541620556,-0.270281044095383,-1.78548214572740,-0.299614690192485,-0.825116153900456,-0.982634018928275,-1.16639019731482,-0.551490496374341,-2.00424739902084,1.02271092966604,0.531481153629130,-0.0226334519590276,-0.0346353044313795,-0.799149343356908,1.07206421321689,-0.123571332112284,-0.717520189649662,1.38347198918382,-0.214642331898774,-0.600870257775178,-0.311010067645142,-0.835875454685888,-1.11912735287718,2.27706154517494,1.65810867026358,0.305281393618200,-1.27827610654417,-0.864678732816405,-0.162732358096816,0.823492798632861,-1.33866739016719,-2.50716355645613,-1.45677746696929,0.341707957697077,0.385898516116709,0.471496780426605,-0.120230110001730,0.188102555390768,-0.495059089246871,0.903150140838795,-1.37048890138094,0.475712745856987,-0.841041609162149,-0.355658489532418,0.577045786233514,1.10134347392430,-1.11292768552199,1.30559700954778,0.691690314585398,-0.0678858546015473,-0.181711555281653,-0.207199230942519,-0.327334427023444,0.0149483810986458,0.0365769452873847,0.869227144755009,1.53850225317069,0.485258994883272,-0.197616509145240,0.652792400612677,0.187155740500622,-1.03062268286258,0.998625881773320,0.304120058725308,0.125249229480518,0.527317658425913,0.248994504139677,-0.941027336708533,-0.147320455329281,-0.131873645618805,-0.549205366785774,1.66791743601679,-0.875866671107801,-0.505083270222399,-0.715363092870724,-1.19928571675873,-0.177263084232530,-0.281964582844879,1.54424957700519,-0.246922856298723,-1.06877102687144,1.60569934082530,1.29058762045046,-0.222719362898729,-1.51639893286265,-0.466214008592686,-0.140895860070840,0.267539276442121,-0.267636176074346,0.463952917492445,0.387212862554272,-1.26775356349395,-0.951789487281713,-0.736572851913277,-0.531705782313013,-0.343887728360245,0.00609614846198402,-2.94677103969083,-0.477638390587101,1.30106014384110,-1.07191914098147,0.988097658891131,0.355976248265753,-0.0284518128430584,0.185631509337648,-1.59215683481376,-0.0847203345743268,1.61032745708680,0.0895286618235649,0.0286828110979333,-0.729244389399516,-0.0301088591741052,0.226304894684789,0.438573816252905,-0.390893255483735,-0.232006983192103,1.95437661648142,-2.35126279856503,2.07750974630104,0.344383204608024,1.05718362291862,-1.70748035601279,-0.604898764814273,-0.289626980688283,0.436149253095133,-1.71911645096729,0.486040691236692,-1.23523092616388,0.0507394215442944,0.684032323700213,0.332823196126945,1.14490120536836,1.06267872367793,-0.658944486045608,0.246494578941453,-0.949417297096320,-1.32011477391300,0.974847556633497,-0.00726724338429886,-0.0558035599345642,0.962794199682184,0.613121575737904,0.355475529868784,1.30292362051793,0.981974395674519,0.232028644615309,-0.699623985582413,-0.661831509466902,1.24672532959959,-1.63179637670763,-0.0258869862478669,-1.95078437602844,1.07469826798449,0.900274493332259,-0.00400720562346144,-0.0716394866142827,-2.62351952400131,0.604672808931205,-2.23254076177983,-2.43996894279534,0.0681153098418296,-0.952372446488040,0.418745568897160,0.712273903374154,0.895899396019134,-0.700052627331088,0.468266771610851,0.0925227365839156,0.872097441822568,0.549006981515454,0.945735334431126,-0.122568008219591,-0.133081282575355,1.06684407201692,-2.11894307522539,-0.524588869535798,-1.28966708918518,-0.404017933603938,0.679347225640049,0.868469606943003,-1.02260368267905,-0.490761643699359,0.129232636979018,-0.307549940786182,0.296817010474233,0.398564062879368,-0.924012000578304,-0.164915090934594,-2.13808204598016,1.21152339690785,-0.643979730205056,-1.22131910309961,-0.257610962391520,-1.44236809924908,-0.0242496208838883,-0.574075540764225,2.03838839083821,1.19941444543717,-2.68465271590191,0.461381753430185,-1.39772561510680,-0.260882541245581,0.158339262341270,0.771984355418670,-0.280389093768315,1.57334956835916,-0.500129521711194,0.333315746137839,0.700659758778222,0.0733287401330461,0.925691277343523,0.326877636546974,-0.777023928237166,-1.81439372231167,1.82444615802619,-0.619987332720458,0.0962374483706392,0.587542002818039,0.110047475776352,-0.907444502715744,-0.484792587426042,-0.113201911643727,1.49513243051842,-0.856075678067587,0.808701752284648,0.307143993633792,-0.228107296847556,-1.05895524831614,-0.298894763682614,-0.0858306935529782,-1.47743222596367,0.194024359908476,-0.813949353349415,-0.0932739357283703,0.342606514313080,-0.904457282243703,-0.304575711543541,0.352572617577838,-1.84325362203218,1.09813936679120,2.21338197826289,1.01086059579847,-0.339094870969624,0.444016867352599,-1.04020041347127,1.83368987341085,0.994017162084283,0.815685726481767,-0.877080883184145,0.322794763662576,-0.571823677747026,-0.337024771647138,-0.581979510369553,-1.02865489641501,-0.912489655697825,-0.198384763046594,-1.73879498681204,0.630348256567706,-0.110836510961866,0.729932871138578,0.257616971944563,0.506647277127558,-1.49536902462969,-1.02546517588420,-0.467117521776877,0.103742650823468,1.19465540012793,-0.305768379124309,1.30903577578627,0.489576763201119,1.24063313918791,0.123046280777001,-0.672677214520819,-1.48963543417089,0.148261178819024,0.856252005661636,-0.309685453338623,-0.558661645289863,-0.335222891661230,-1.10574322469937,-0.512938491816999,-0.168450967233673,0.0291251373963851,-0.0644914301624363,0.638640522818124,0.102215346268232,1.79174292447139,0.311094725672914,1.77115884370542,-0.721264270008335,0.540406020543074,-0.267295299675319,0.619044519779122,0.612708958186803,-2.21417894279681,-1.33381977859529,-1.44555062060016,0.404592608122766,1.48894480631240,-0.351018455005377,0.851284672601111,0.563850659052344,-1.05521019411055,0.395432684006333,-0.740987227673242,1.52321882021789,-0.0318164988422061,1.64695310591196,-0.442521136052716,0.610028468606454,-0.0625796916324510,-2.01351006769362,-0.985895154616093,0.640263420293534,-0.0539225012954382,-1.11485507428051,-0.642206254350983,0.244268602437860,-1.00359074950836,1.03570226583701,-0.656568131128464,1.77482874156758,-1.08549720586944,0.201461047200581,-1.54172464724008,-0.723033144058149,-0.606983473862385,0.403598758261492,0.994752493991780,0.295798048237359,-0.393020542422628,0.853056623761886,0.835474873968269,0.113702516046839,0.596337616435643,0.424661439541344,-0.988883445223368,0.783306738169242,-0.673840963332079,-0.618687318493027,0.174504365134419,-0.332432658440731,-0.121552018803478,0.615131455138088,1.11032076701139,-0.187162165732740,0.337820972267160,-0.234608554469278,0.225963937320021,0.459206961059680,-0.628108879375541,0.263859231803297,0.624600688512030,0.0792150226936632,1.69692027072511,-0.621718192457011,-0.733814178520775,-1.77522762142146,0.959327273002599,0.911597644490723,-0.0785944451835494,0.946494532231884,0.189779104637651,0.284517149995860,0.107209372200906,0.457612174391817,0.0934734590624713,2.55153380349913,-1.17901404252231,-1.87052006315367,-1.13932754160661,-1.09902805923827,-0.454358190482642,-0.154786261322299,-0.209073093832287,0.560764668902187,0.385191626759648,0.777208801029826,1.73984501878041,1.28084833912347,-1.29886260513716,-2.47873074424841,0.955864889736783,-1.83760837681775,0.0525438243168421,0.0221195895450974,2.06849584872535,-0.0709785609118216,-0.531124773188519,0.227997701874905,0.241157086978738,0.0587644067317797,-0.623055470512473,-1.24601683900547,0.315146453537211,-1.35272773693338,-1.03233410487099,1.35955088624383,-0.434440573163652,-0.129243981969610,0.948577157326529,-0.320023992954755,1.08584881322521,-0.361057009233580,1.07066191511776,0.659139073135998,-0.200104823255622,-0.866510301630426,-1.04678052396828,-0.275476165031283,-0.455545555873031,-0.421559540716280,1.04399078010196,-0.317285277218454,1.20877710462276,-0.548378321175455,1.03365182071805,-0.540657191118537,0.172700865054837,1.02906996044202,-0.428641674049785,-0.456679173097791,1.92796408597197,1.00680679423263,-0.452233407624311,0.680955046376560,-0.372560072780992,0.733718699226508,1.44244174645888,-1.62438394035397,1.08294832641063,1.48314897718877,0.0316416367062807,1.71712074694167,0.146732873017950,-1.26363307523569,-2.24673459087291,-0.353406746709241,0.734266713679939,0.317686055258929,0.427137969339074,-0.591153510969352,0.136506348970076,-1.69062769732368,-0.750462879144128,-0.812492908303433,0.529760107953876,-0.0192267190308436,-1.16082604149963,-0.0152545566943575,-0.697322905221156,-0.680319230803447,0.909277476920086,0.108415222513623,0.396897475242513,0.929879853275084,0.179971121825572,0.573666942553015,0.714988059819505,1.23651010857947,0.492225870226178,1.43269582206427,0.0116379466767692,-0.0510059486982618,1.68515131882443,-0.534168926348376,-0.00953501623953004,0.968192975669388,0.143291914004635,1.41773306623184,1.09165065958902,0.284832845843586,-0.767936947081859,0.593747661989091,-1.37677098145446,0.238645927068355,0.846608686826384,0.209083650068117,0.924877430528321,1.98206182885658,0.973442605053328,0.254672775823506,0.670474363787357,0.437365495181785,-1.31178722496074,-0.433656386606107,1.28204657989741,-0.0438690365287439,0.605986153901343,-1.01506558959267,0.0492262127121469,0.621048929469686,-1.36889780389631,0.348020884198555,-0.169961530379976,-0.939734714383478,-0.0380843533040131,-1.87696110196428,-2.13101252691595,-1.20039712183896,-0.998899649286777,-1.19643094324871,-1.75970988864062,0.279241247639807,-1.61948956591093,0.104352476071383,0.813189126592685,-0.00806863960472442,0.0812033566802261,-0.400192479018141,-1.49317554671224,-0.0441984083186185,1.01494380654361,1.70849245657907,-0.450746594616748,-1.65876580321987,0.158791242617890,0.376959482950569,-0.219249648466131,-1.15736061707016,1.97629831728572,-2.57089357961127,-0.535795020542282,-1.31716854536323,-0.654293052684203,0.319332731004625,0.129660509666519,-0.711893695415274,0.795343407539888,0.651842554666864,0.675866450840011,-0.442859013938015,1.11495320443664,0.692532552863547,2.26904973237150,1.12671073406246,1.22637361747725,0.0395426455125757,-1.30387035237282,-0.388479798643216,-0.746113623779510,-0.577690609422958,0.582998610350745,-0.569198204023446,-0.890997274511784,-0.422416254690426,-0.145114297298426,0.416745359624518,-0.962935207615630,0.317004908873668,0.0657238869180220,1.35795045956470,-0.201763710986905,-0.125578868811772,-1.18965476058255,-1.38422003314213,0.309760330335999,-0.250629864186232,0.517130247792559,-0.887770733242800,1.85916090065948,0.117040328441247,1.11346811406547,-0.217737251342891,-0.148721544452389,0.721609117939163,0.585384088974504,-1.11948888734654,-1.55094431490746,-1.10783828961244,-1.41663324473349,0.0462344541552408,-0.426756101714823,-0.385184049184399,-1.36374968444128,0.802748389334493,0.455750906069802,-0.0889458218438761,1.07729482168994,-0.872458902556057,0.430073275114326,0.350349270597043,0.350797161843688,-0.726481777038634,0.330968539634518,-0.538400249849952,-0.893800497832445,-1.22024686285256,1.09874853971816,-0.833899448120654,-0.158421610117168,-1.23311601569953,-0.314872234200490,-3.31032844864178,-1.09324610833719,-1.43709143718187,-1.02084298339597,-0.202728073670448,-0.349826445158970,1.90550000319455,-0.586566050121497,-0.251390773183892,-1.60043479322057,-0.497177304514119,-1.34814820933406,0.0174004562632860,0.888558461540941,0.407439925084644,-0.707653039836614,-1.66441334327578,1.48624181965598,1.98846448268747,0.116086354974821,-0.997345061091832,1.26600849656937,-0.606015657861638,-0.489696566767023,0.931212397508969,-1.37963827495860,-1.96073119498339,0.434636956504147,0.401041476872756,0.0868694225879451,0.509817436037925,1.14282956469767,1.02597120243455,-0.581173317340248,0.848787058637524,0.167642855224876,-0.528772722339888,-1.20954035370234,0.672920898140827,-0.369857067358064,0.0302426777320157,-0.787601599975912,-1.56743751337306,0.166297652410272,-0.0596483124382476,1.26902692245211,0.837453250115718,1.11998366427329,-0.738869335215619,-0.927579106507634,-1.28704869869465,0.512149362304084,2.59446278732756,0.757923907036218,-0.760943141668812,0.879831056892355,-1.13585320216183,-1.43430081832131,0.747117579105414,-0.771274647493810,0.314125081261147,1.42135626258682,0.402666951221008,0.978488544663641,-1.62918735551704,0.695838866819256,2.02537297083971,0.559952445826222,-1.55709455275665,-0.189390569579573,-0.518066060139875,0.379734155940412,0.420593113106315,0.411530873182392,-0.378052706140111,-0.611633385991639,-0.602872186597550,0.889694574701691,-1.86312492386319,-0.194387571349123,0.260900553060643,-0.661956655689657,0.493841442525758,-0.0733702204815727,-0.934899429461692,0.153927578711644,-0.274133435787185,-0.424940123015893,-0.714289999686560,0.0476742529026333,-1.85239526001081,-0.414502525097472,-0.561968798264005,-0.915827983456308,0.685807874276881,-0.731970770053880,0.555388476191423,1.04072706527361,-0.142582048211362,0.269032847314036,0.668710212518380,-0.0795172935920601,0.556847020410988,-1.27939858902658,1.17856505593069,-0.996477340952057,-1.82401160383765,1.41086832242006,-0.0610523188232600,0.467198139642003,-0.375870633757229,-1.02594817359032,-3.12972601965135,0.656019859050427,-0.302966256870609,-0.184694390730143,0.412735212668811,-1.42464039564252,-0.727600234504643,1.22007117589868,0.616824666413390,-1.29731884619279,-2.28330180800877,-0.584544263378722,0.210976856648453,0.997256146054428,0.0838660412433447,-1.12772970287171,0.301633304952673,-1.19211310756738,-0.971469944510679,-0.665808078325749,-1.25703853562836,-0.277455029747198,-0.902575509449763,-0.300650919750444,-0.483009208608460,-0.424618533765071,-0.521231647082101,1.28748352072071,0.636917105728760,0.0444853352903491,-1.47440345531210,-1.65420032108980,-1.98328116796622,2.33796251404170,1.03057533485319,0.244533532542217,-0.979365018282292,-1.14329771613287,0.568165849444646,1.56726142594824,-1.73088108973917,-0.473465447210163,-0.0832913765199210,-1.99367880156698,0.886693208300292,-0.430110067020819,1.86122331781145,-0.410250974183501,0.416220145494120,-1.14129508628339,-0.641446304992692,-1.18517025470956,0.388446972866121,1.34192511320604,-0.609409088283590,0.452404986051952,-0.523514754037743,0.0950687675097077,1.26219821869379,0.114544596669771,-1.04388439485945,-0.852549751057734,-0.156757801434702,-0.175339829480190,-0.867864873772636,0.181015979577793,1.31260885718989,-0.254287755681021,-0.191052799226967,-2.26997079470741,-0.765799675351351,-1.38739321136637,-0.404360673920042,0.537675389989386,1.52733162770201,1.76273017489405,-0.109370738413127,-0.343673873449338,0.855074414109293,0.502074803094696,0.788650902554935,0.799367262289829,-1.48649065848477,0.553173622929611,-0.0908276816160492,-0.753120330330508,-0.703085531788057,1.31795908706007,-0.806404785047981,-1.25971147168865,0.214191139782620,1.94565189561579,0.0162127788455913,0.305812170287319,-0.933465646817457,1.66051288772953,0.121393196689586,0.545631789620655,-0.962070982754116,0.891393355849655,0.383413515973963,-1.16282288578827,0.0254016950071309,-0.475595343119221,0.101600425275108,-0.252209038900798,-0.175077924823929,-1.03535489803947,-0.347817047116040,0.790811785411964,1.71611566969562,-1.16973773968677,2.19080619588693,1.53590836305763,0.164300667371087,-0.322687110774322,-0.706137949888170,0.875524537129028,-0.703521274777258,-0.481155752622285,0.927868320661531,0.451862125242904,0.943049447954323,0.518745539326330,-0.417408587310461,-0.536349306271591,0.832361048527427,-0.684656244809371,1.24528433925424,0.820596425640687,0.277221421188952,-0.00276179699403580,0.372500933857956,3.08233663290942,-0.105299937499683,-1.58240534491664,1.86953794820216,0.634787739217998,-0.658340117428565,2.35804676196852,0.575315073880868,0.291778021448491,-0.768900877947653,-1.07079471672754,-1.79306833256757,-0.439849994056581,-1.05755662174867,0.677738596891776,-0.340491216878239,1.73218344980403,1.51702661190440,0.156347681327644,-0.296292573142490,1.22292849273194,-1.14732544347743,0.707734661188689,-0.683322697628753,-0.415782173090194,-0.688291422741458,0.600367749515045,-0.772353321580442,-1.06572264809015,0.578924564409904,-0.440095472149144,0.367222815038087,-0.367363625343675,0.256160382579983,-2.76502042949664,0.483976758530630,1.80621840385526,1.10375235106649,0.961617311477586,-0.237537064959226,0.182371837306296,0.237489016953307,0.0890953815317802,-0.822793754581837,-0.368416002259657,-0.160235327581067,-0.499099713098538,0.882988441981706,2.29146240909488,-1.32811593572724,0.123896494862140,-1.44834502679947,1.34518655770348,1.43079275753387,-1.70213433729036,1.89577547525382,-1.08749903615296,0.223865891600675,1.16003972538423,0.139149569991176,2.11127423851031,2.49363170697716,0.133030527050636,-1.90294444361619,-0.383354776602259,-0.836722468563607,-0.754712628313184,-1.13330897661514,0.0666057142632703,2.00951536736096,-0.718324446667651,-0.292782709745016,1.23439617465402,1.27657086941706,0.497080978805945,1.07952013651352,0.914611020833371,-0.402774014970601,0.445413110272523,-0.319752551193737,-0.900767540525566,0.664687574479189,0.0545607870053881,-0.173484050206316,0.288188284590239,1.04674700924570,0.389405323654498,0.196021630421711,0.271112635626782,0.0351405051771983,-0.765281344845790,0.811305895144882,1.42553780764454,-0.552963744899171,1.88917990215991,-0.161268804425189,-0.243057341365519,-0.895720974230338,-0.786805580042881,-0.965122282249898,0.362461073654075,1.59510421376730,0.541814907959025,0.892969443629714,1.37505860498242,-2.71410895045888,-0.153811884128869,0.359046459983966,0.744436032017775,-1.30556893320600,-1.01270338970975,0.818983825889478,-0.108979301269560,0.582320086065795,-0.968197581287261,-1.67318290117749,0.784080411764485,1.25863423227802,1.63947887678422,-1.55022665377151,-1.34533107378632,-1.48272234978732,-0.0423871321384317,-0.625240475739653,1.35240059293837,-1.46125377210441,-1.77202119760185,0.204737484344387,1.25491101721766,-0.799548820859351,-1.28437832057631,-0.133877983609881,-1.68148883910950,0.00980874018413231,0.873068693933479,0.217812589787877,-1.90910138118032,-0.556533088383714,-0.325710746389360,1.78572404100312,0.966386918051949,-0.0568532059040039,1.34919233389311,-1.04722896553198,-0.364883879733285,1.43777674980077,1.50806519176661,0.758969315354743,0.503343420614267,-0.600261587999166,0.770204107465646,-0.821345487529894,0.597820253435511,0.272033811297258,1.20343360350062,-0.445421098680362,0.665257319136851,0.825277897793714,-0.898413072071376,0.149129911548642,1.60264164184122,0.106136929954456,-0.334438352246815,0.477158932441513,-0.283734860663760,0.462906436956661,-0.126711032549607,-0.0210881306245989,0.482496902043928,1.39048859507151,0.472001288981821,1.65098888935929,-2.02116809789943,-0.473224410604995,0.230748619490310,-0.828816728432593,-1.29144958395270,0.646664352959385,0.641203569464077,0.280963524601198,0.392110677394639,-0.871508254198477,-0.516407133313338,-0.0981756192825640,-0.692415238834057,0.339662280753481,2.16516293059694,-0.501996339286020,0.677100636386146,-1.03818726335721,1.36729874374926,-0.977182362968957,0.206021253262029,-0.629717031742104,0.526378213109350,0.00332548884301532,-0.0455544430656446,2.67046545347127,-0.647766381493318,-0.0491478923415975,2.37241035623489,-1.15011097016059,0.581061274525032,-1.08324043615849,1.08822334707284,0.334648964300943,0.683166854236682,-0.291429304770009,0.239737246616982,1.49247659094646,-2.41844047491469,-1.66463681249075,0.430677659893313,-0.669003488184234,-0.313871372460678,-1.50651480882434,-0.908448294162860,-0.418248076187650,-0.724438622041146,-0.870208959740474,-0.437696143586952,-0.944436915090547,1.37744388874384,-0.991943667666933,1.79807390022397,-0.396023379255686,-1.45857980893509,-0.631566442280331,0.989938386008645,1.12222399041919,0.153416323281489,0.275476687419170,0.663269120504790,-1.46576046859457,-0.595793972466912,-1.82594298684129,-0.471214012234786,1.00121820527481,0.745567295556607,2.09996291120301,0.160166588584764,-2.16233088953704,1.68370087743906,1.32394638837381,-0.596590339450743,0.222605715286614,0.800082615179979,0.380174030430267,0.724442888319052,-0.106064855835534,-0.0392507463818948,0.0769195069138089,-0.782342786753427,1.45463645218131,0.000213588735692584,0.718083043348754,-0.848059808083220,-1.08201215744168,-0.0897281096101086,-0.255761676781448,1.26166869028939,0.626528200307373,0.554701636992472,-1.45217474539779,-0.974925874947984,0.204315395117965,-0.363440524944213,1.32971047455137,1.36969231646730,-0.594117720570620,0.917632457782096,1.41326855562086,0.323992081532600,1.62636772634663,1.12519218935039,0.212407899898278,0.920190858349412,0.194443282947646,-0.430712376692155,0.363841800508787,0.0234664363258147,-0.380024580157606,1.73494118329703,0.221335527913521,2.41069085758681,-0.312483664628408,0.589085277176093,1.57811910316628,2.39847956941058,0.300467280746200,-0.783986394804863,0.841485021266402,-1.31565063851705,-0.280928717912005,0.261899538330643,1.50133814195528,1.46532410367097,-0.0275706054659470,0.970796248762441,-0.347393058985995,0.693601260241382,1.87576429706186,0.150248764623683,-0.321780282913637,-0.519566975706434,0.741544717690427,1.36450837723048,2.02014162070673,0.0407836188460058,0.155403260554822,-0.652483266549007,1.62012033027779,-0.0744385991231325,-0.492415174154244,2.04874626724639,0.848315623377078,0.739539285829653,-1.01078013625486,0.450900934154963,0.532411710179531,-1.09637261770723,-0.216706910236619,-0.420033899512524,0.543525471951300,-1.01571124887702,1.14650233473481,1.75383389179840,-0.330345365336967,-0.0146152110256342,0.522454556290728,1.27489280442298,0.535572963944953,0.393496879707605,-0.503373358303901,-0.225176983833491,0.644330260393316,1.67089899996480,0.595205820628424,-1.22573315856831,0.446818343391014,-0.0920911065155974,-0.245462288665146,-0.209982085327958,-0.878996973028834,-0.345521692789670,-0.777481092078627,-0.381797404198725,0.110746100678739,0.170036825579718,-0.205555667455580,-0.137145005713306,0.0208845992169138,0.478581855242544,1.32155071137275,0.649547664316974,-0.302262780317925,0.617736191102305,-0.246677077089830,-1.80017436477461,-2.53963243392754,-1.75129635148723,-0.233652319191740,-0.635241948839570,-0.720393858298690,0.0274091106051167,-0.675191335144532,-0.648763562405087,0.633311124210656,0.803199011026358,2.23105139345651,0.297865476565151,0.0432136264879832,-0.588727474718223,-0.180279277797896,-0.0520881162483616,-1.78835755471776,-0.264338495591496,0.774415934177756,-0.583150869606404,0.504929774085605,1.05303232736976,1.13379428885288,0.794106567477659,-2.38892846350773,-0.579812772901785,0.953863182744568,0.391872344279634,-0.00144827090131125,0.455027340684764,1.19662070999312,0.145053165412982,-0.750142810280048,-0.167203710627861,-0.196412530849567,0.941453325232259,0.422433557612504,0.566641079230390,0.140195185741480,-0.373609389955585,0.0466529735375791,0.216964017374354,-1.39251766165287,0.177055622296056,0.976898535699563,-0.101208851147455,1.57125846859114,0.587118991452891,-0.436167038356769,-0.139235233701221,-0.285072377565733,0.234200944384263,0.780774534479102,-0.308632713236859,0.480246379724687,1.72475748740628,0.984748404534908,0.864487318949712,-0.809014048317383,-0.553708514449803,0.235347186703715,-0.0947445961002084,-1.64747717531901,-1.52291911484686,1.08235245745247,-0.747204986453371,1.99705223552696,-2.30389529847253,0.466027668685739,-0.00613515927479658,-0.744927251298806,0.408840322536610,-0.792602213311982,0.900162664478759,0.0533861335639406,-1.69798805505380,-2.59655089102488,-0.296410339365126,1.21422935284662,0.185225326360503,0.0419270776439616,0.719696266886469,-1.39005528728571,1.45880930568036,-0.889403578558984,0.0242594489391927,-0.376400253307990,0.141969986476277,-1.93800601680397,1.53305273987862,0.566224340285143,1.93800244661041,1.44476847873745,0.00449535497998043,-0.936954024007497,-1.76751842334634,0.00769416106019799,0.219470009914456,1.10857077173996,-0.957687205217020,0.827498013938307,0.0590408098263391,-0.762745508749190,0.792339676148130,0.253610153845445,-0.230264579185633,1.83060966925965,0.632047517042381,-0.102761525904523,0.268151401775216,0.0757899929877573,0.168835749422315,0.473894588635146,-0.614340988010999,-0.797448463166707,0.365673385004651,1.84196743330603,-0.330884725708098,-1.01786544838030,-0.235888759902764,-0.506119647636406,-0.351849147791582,0.491363688399660,-0.118411576372627,-0.610090151900339,-0.464353768734911,-1.32498448779831,-0.855653649876243,-1.41115890985542,-0.539862462705359,-1.09130062658045,-0.710782679373806,-0.324187343999010,-1.21857206594171,-0.0214253203617034,0.345590324278642,-0.972534272124229,1.18190380232833,-1.61338766094378,-0.411368786935395,-1.50046819312275,-0.359729750077440,-1.32973562487324,-0.589664596431542,-0.734911387379517,-1.20738123935574,-2.05791322860377,0.590495217665927,1.91950475591918,2.05632875014914,-0.510481162839946,-0.0473890146653522,-0.483335927347359,0.0608175036968821,-0.920351103009968,-1.91654152236635,-0.0368348832900109,-1.25557164669648,-1.88735409304051,2.18272797751206,-0.226436703799837,0.405836054882598,1.24966555099558,-1.72466043152441,0.424832009656126,0.514717782551772,0.0715236571167115,0.151940942388259,-0.544781544494920,0.751445510444899,-0.844303684993290,-0.793597575898008,0.752123768296469,1.67725383818666,-0.407556757097573,-0.528712348407935,0.414837319097903,1.13192652804070,1.02372696222342,0.258953457923448,-0.653086018852612,0.661126602126946,-0.0765286306121604,1.39876392091594,-1.40307117359910,0.134128193876111,1.32566531360074,-0.515019559882790,-0.639169990064406,-0.925097153951333,-0.290520828584582,-0.188037912581487,0.128095882738151,-0.882661045265874,0.0711391438914374,-0.616388593305347,-0.386299088743369,-0.830702544936294,-0.294138484769444,3.09596342053974,2.88184281376896,1.21804719824632,0.813784798959821,-1.29481380618318,-0.599137678637914,-0.633514886412403,0.546529321164858,0.494796642013246,0.0999486377825263,-0.356122942800386,-0.921167007922697,-0.000591718307374020,1.20127363949114,0.440908872781989,0.183357066211504,0.689918141454487,0.609342400436687,-1.64316148698827,0.0101628063416441,-0.446634621807195,-2.02575317125604,-1.33584204808352,-0.342317300887208,0.866426114767188,-0.222360577247745,0.249958868401724,-0.896783125082924,-2.18113002037569,0.0845040372026484,-0.959208841192330,1.23925432122858,1.70582774167999,-0.389688874116594,1.25257309094647,1.00762722273807,-1.41518622618517,-0.0328517080843312,0.247195298159300,0.536104503102868,0.710374019392987,0.709266821565591,0.713056297905067,-0.337787285188482,0.378423130988912,-2.34309955397726,-1.18159909295916,1.27277672849309,-0.677495600452240,0.337108624693898,1.51394515722265,-0.887125322497695,-0.967460619988001,-0.512039577513180,0.460016573718407,-0.192645632976214,-0.980273513685390,-1.60599926092954,-0.387618100528171,-0.211443636744671,-0.555697442551314,-0.269349283540178,-1.10345557294628,0.570410671372658,-2.19616378021528,0.138018185128425,0.702510258102881,-0.842201028898037,-0.0577893545006524,0.289089791382821,-0.624701276513535,-0.0186812493440557,0.421043118939395,-0.929525137366009,0.879190458407504,1.15353292460858,0.325397223075885,0.00636117825947251,-1.17269347939695,0.507958178237131,-1.24028030373737,1.59258682460498,0.539004192737429,0.253093092015004,-0.412628733123295,-2.20496850036281,-1.21154818483146,0.371343045087412,2.20021648481409,0.765726292051646,0.308528475016567,-0.559848061624834,0.118536104093505,1.02108518511191,-0.259327284638868,1.84749666415442,-1.24427334823750,-0.396611880170242,0.0384054679978270,-1.95292469575330,0.592082475112759,0.0645997711682383,0.0697977690935782,0.826051177562110,1.10713213247114,0.838330993860149,-0.488517302611045,-0.0487057774086973,0.360637855012471,-1.27413162987654,-1.04258904480327,-0.447469519456848,0.0632460843302202,1.75830688519233,0.832794003418128,-0.462875392162421,-0.645870194963199,1.55238181309979,2.43414262228861,0.161291566100213,-0.497508995880470,-1.40567282173565,1.03805703127334,0.282250055198516,1.23133088687483,-0.911528341669614,0.233066666179566,-0.666917919893551,1.31396406520664,-0.566446063753617,-0.0877966040491988,-0.361896466850522,1.05469928429166,0.442431952839442,-1.00793363958990,-0.650372667628165,-1.04974640421825,0.520817525766436,0.340426829042697,-1.67567845153967,-1.89285743501930,-0.0401498182118969,0.728481660752848,0.165522172328359,-1.56036679801922,-1.57438785629846,0.910873684348448,-0.129622527352756,-0.406893532250240,1.35430039926218,-0.795468158687165,0.126071495974288,0.431995673441636,0.858091070708592,-0.846124413362496,0.363606504782909,2.47347372570523,-1.52132228481408,0.449360855633902,-0.224112167831885,-0.820320315523396,-0.827076492159366,0.511184047531749,2.12007438043918,-0.789300727907121,0.558613560782078,-0.573072417820124,1.91572355251435,0.563474348321475,-0.127460809999828,0.648574339668237,-0.0112651025336384,1.17194310167233,-0.171734935941513,-1.12465853703761,0.242630698109320,1.56242292674413,-1.21339943987461,-0.241005832820624,1.06198247716869,-1.92578461357812,0.654905481559368,0.779111332322103,0.209607622157074,-0.759732372586322,-0.0126825948895037,0.0816481227536888,0.991188467523672,0.696870860422371,-0.365717985437053,1.62291649281647,-0.0527523391726407,-0.808026672884691,-0.458827673295384,0.898152037219964,0.197162691897859,0.937705445986067,0.0575778359205062,2.25370903077157,-1.71278988806289,-0.431956063051928,-0.0824397903330680,0.0780929029440762,1.47747898798884,0.220407912789094,-0.107528864879799,0.0551920569210155,0.777889297544243,-0.696046763518558,0.469224483233519,-1.58736870268556,-0.0756914478797270,-0.944248138838348,-0.664203494983038,0.274628663337076,-1.13046642646357,-0.993797996649036,-1.52689452598999,-2.30945444810233,-0.136121133899845,1.22688047424249,-0.170724187796576,-0.229429162443119,-1.05250111529466,1.58145523816963,-0.249019006224851,1.33261637312167,0.368955329879855,-0.272070745346268,1.13947500881991,1.04207839943273,-0.103558619645404,1.33663312343474,1.74619457929337,-0.0657007740579178,-0.263340114492029,0.410443102402673,0.357484430036751,0.841732755331726,-0.261790782774542,0.737360633075826,1.11881705869405,0.175262699789519,0.144529082610458,-1.27154565397750,-1.19272250145056,-1.47136764156120,-1.26514099241503,-0.139778997727403,-1.63610126008383,2.08918096144159,0.763418645621728,-2.06734246902063,-1.15955099009507,-0.0998053634400773,-1.75016100667178,-0.478995054246869,1.14928919516542,-0.151694690274016,-0.0671843638469318,-1.00649777078746,-0.566764928734335,-1.36041105134902,0.370510543596604,-0.477439921078756,0.806826760233268,1.29375140164902,1.13795597808688,-0.0355380820505206,-0.521743892862298,-1.24944248005406,0.112018608160446,1.01180171715101,-0.358042379813290,-0.159391507027499,0.645305357183833,0.906143609287143,-1.42080641716495,0.202941711683991,0.198603000196445,-0.134715985453861,0.938658607593389,-0.378683837028065,-0.817467236561901,0.265556725060116,0.481058059347311,-0.206763350714053,0.830014159388867,-1.53504534657049,-1.07966695296706,-2.98332317274557,0.533542475757296,-1.00195357078539,-0.256233304238916,1.06875023701542,0.0348913821136255,-0.460927818056071,-0.838415739695530,-0.239078076773694,0.626455969535788,-1.53394783879426,-0.0690192362283127,0.804737611164809,-1.42657510466318,0.703851796609384,0.716208947239619,-0.881395864753541,-1.51091154329874,0.447296879795820,0.843513657137857,0.602298127383331,0.787297154120307,-1.20340120769710,0.607157262578198,-0.591850756375137,-0.575536200612929,-1.57823830006081,1.16541785384357,0.171288348727259,1.06030823812003,1.51987415393140,-1.13795648819329,0.671488883228760,-0.0173534445317229,0.964333256028472,1.17312375354650,0.861218905749112,-0.810781817896595,-0.117036451001184,0.250978008883136,2.81170218208657,1.28678428913211,2.13349993087363,0.428361619797953,0.207803282549712,0.642927024525234,-0.544449607222970,1.29667945141059,-0.143934582316026,-1.37448758742125,0.915471169047719,-1.59449199560788,-1.84694298681249,0.279786995981018,-0.955764183245576,-0.915085723821306,-0.146404744179176,-0.507385288265739,-0.212240106354518,0.263246662008696,-1.18461148376045,-1.25140873970923,-2.10594696238412,-0.409264844779312,0.699841736937786,-0.709177678141774,0.513041111591855,0.551206225174101,1.04974795003992,1.04910161330452,-0.694704963985037,-0.852251958772574,0.0328017187663233,-0.678049041995183,1.47499822077244,1.40667994642243,0.0860868750268040,-0.448876304678125,0.524409279610452,-0.670725332832704,-0.115492088027454,-0.546809584334879,0.0986225732154018,1.19069674663611,0.767567685672931,1.20697206044588,-0.917373412687553,0.178808817068590,-0.987899206653395,0.381738173191733,0.330486574162229,1.33904179581990,1.16080846056781,0.688543784036302,-0.526150918701914,-0.494165957158466,-2.03489600451804,-0.468932197890030,-1.57145739207168,0.984209012167284,0.957376690549832,0.131767982830403,-0.400946141777452,0.135645337608839,1.61625464853826,1.37887522151565,-0.470457196801111,0.163200048502296,-1.12319238837378,0.400120253582839,0.761752203386483,0.952113143707636,-1.54423818808047,0.518441742810535,-0.861416497449790,-0.398077664881283,0.816952852578728,0.292735612268941,-0.150437942249927,0.628707972234967,1.64144323562167,-0.637199395925204,-1.35877630421193,-1.17230869877440,-0.946307627017429,-0.686852992844522,0.601109080263249,-2.08573247413711,0.229825134328126,-0.775438728499195,1.16346226584723,-0.848975941077813,0.00217054011472373,-0.932194231203518,-0.691590562817066,-0.265147616409971,-0.220437758880662,-0.542054534566249,1.18777337193783,0.572002438500941,1.81283325089080,-0.286180140751953,1.12904686828020,-2.08784595791382,0.667020257676060,0.375845594341717,-0.394302577103846,0.723183961736049,0.922291762662903,1.09113712678597,0.433306444599693,0.623211655362817,-0.689496527773967,-1.10079209211408,-0.273051812064785,0.191051518597898,1.00304691438646,-0.784308789924643,-0.509691251491262,2.71184105134497,-0.635709923227411,1.88456303241602,1.01738273829499,-0.569690626680382,-0.0975913590569130,-0.203989814227001,0.487937399277812,1.39340080476031,-1.68789103785550,1.96489402655715,0.797645499233041,-0.564065710043580,-0.116269868652570,0.294163024476568]';
% xi = lhsnorm(0,1,Nmc);
m_squig = f_squig(m_dot,m1,xi)';
q_squig = f_squig(cooling,cooling1,xi)';
alpha_squig = f_squig(alpha_s,alpha1,xi)';
T_squig = f_squig(Tsteam,Tsteam1,xi)';

%% Import CSV results
formatSpec = 'm%d.csv';
for k = 0:(Nmc-1)
    A1 = k;
    str = sprintf(formatSpec,A1);
    hold1 = csvread(str,1,1);
    E(k+1) = mean(hold1);
%     E(k+1) = hold1(length(hold1));
end
hold2 = csvread('nominal.csv',1,1);
nominal = mean(hold2);
% nominal = hold2(length(hold2));

%% Monte Carlo to compute PC coefficients
h_tuple = tuple( P, n_var );
E_i = zeros(P+1,1);
for i = 1:length(h_tuple)
    for kk = 1:Nmc
    %     xi = normrnd(0,1);
        E_i(i,1) = E(kk)*hermite(i-1,xi(kk)) + E_i(i,1);
    end
    E_i(i,1) = E_i(i,1)./(factorial(i-1)*Nmc);
%     E_i(i,1) = E_i(i,1)./(factorial(max(h_tuple(i,:)))*Nmc);
end

%% local sensitivity
sum_em = zeros(n_var,1); S_p = zeros(n_var,1);
for p = 1:n_var
    sum_em(p) = 0;
    for k = 1:length(h_tuple)
        ip = h_tuple(k,p);
        if ip == 0
        else
            sum_em(p) = E_i(k).*ip.*hermite(ip-1,0).*multi_psi(k,p,n_var,P) + sum_em(p);
        end
    end
    S_p(p) = (1/stdev) * (1/nominal) * sum_em(p);
end


toc
